# Fix Colors
set -g default-terminal "xterm-256color"
set -as terminal-features ",xterm-256color:RGB"

set-option -sg escape-time 10

set -gq allow-passthrough on

set -g assume-paste-time 1

set -g base-index 1
set -g pane-base-index 1

set-option -g prefix C-a
set-option -g prefix2 none

set-option -g focus-events on

unbind r
bind r source-file ~/.config/tmux/tmux.conf

unbind %
bind | split-window -h -c "#{pane_current_path}"

unbind '"'
bind - split-window -v -c "#{pane_current_path}"

unbind v
bind v copy-mode

# resizing panes with hjkl
bind -r j resize-pane -D 5
bind -r k resize-pane -U 5
bind -r l resize-pane -R 5
bind -r h resize-pane -L 5

# maximize panes
bind -r m resize-pane -Z

# mouse support
set -g mouse on

# Disable activity events "{SESSION} is ready!"
set -g monitor-activity off
set -g monitor-bell off

set -g history-limit 5000

# Faster status bar
set-option -g status-interval 10

# Default shell in no_sudo
if-shell -b 'test -f "$HOME/.no_sudo_indicator"' 'set -g default-shell /bin/zsh'

# Enabling osc(remote) clipboard
set -g set-clipboard on

# vim shell navigations and selects in tmux panes
set-window-option -g mode-keys vi
bind-key -T copy-mode-vi 'v' send -X begin-selection
bind-key -T copy-mode-vi 'y' send -X copy-selection

# Vào copy-mode và bắt đầu chọn bằng phím `v`
bind-key -T copy-mode-vi v send-keys -X begin-selection
# Hủy bỏ việc chọn khi nhấn `Enter`
bind-key -T copy-mode-vi Enter send-keys -X cancel
# Sao chép nội dung được chọn và gửi tới `xclip` để sao chép vào clipboard khi nhấn `y`
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Instant switch to a new tmux session directory that exist
# bind-key -r f run-shell "tmux neww ~/scripts/tmux-sessionizer"
bind-key n command-prompt "new-session -s '%%'"

# Drag copy using mouse
unbind -T copy-mode-vi MouseDragEnd1Pane


# List of plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin "christoomey/vim-tmux-navigator"
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'robhurring/tmux-uptime'
set -g @plugin 'jaclu/tmux-menus'
set -g @plugin 'sainnhe/tmux-fzf'
set -g @plugin 'olimorris/tmux-pomodoro-plus'

set -g @plugin 'omerxx/tmux-sessionx' # default keybind "<prefix> O" to activate
set -g @plugin "tmux-plugins/tmux-resurrect" #persist tmux sessions after computer restart
# set -g @plugin "tmux-plugins/tmux-continuum" #automatically save sessions every 15mins

# Instant switch to a new tmux session directory that exist
bind-key -r f run-shell "tmux neww ~/scripts/tmux-sessionizer"
bind-key n command-prompt "new-session -s '%%'"

set-option -g status on
set -g status-interval 2

set -g @pomodoro_mins 40                       # The duration of the Pomodoro
set -g @pomodoro_break_mins 5                  # The duration of the break after the Pomodoro completes
set -g @pomodoro_intervals 4                   # The number of intervals before a longer break is started
set -g @pomodoro_long_break_mins 15            # The duration of the long break

set -g @vim_navigator_mapping_left "C-Left C-h"  # use C-h and C-Left
set -g @vim_navigator_mapping_right "C-Right C-l"
set -g @vim_navigator_mapping_up "C-k"
set -g @vim_navigator_mapping_down "C-j"
set -g @vim_navigator_mapping_prev ""  # removes the C-\ binding
set -g @vim_navigator_prefix_mapping_clear_screen ""

# ---- Solarized Dark High Contrast ----
set -g @bg      '#002b36'   # base03 - nền chính
set -g @bg0     '#073642'   # base02
set -g @bg1     '#586e75'   # base01
set -g @bg2     '#657b83'   # base00
set -g @bg3     '#839496'   # base0
set -g @bg4     '#93a1a1'   # base1
set -g @bg5     '#eee8d5'   # base2
set -g @bg6     '#fdf6e3'   # base3

set -g @fg      '#93a1a1'   # chữ mặc định sáng hơn
set -g @red     '#dc322f'
set -g @orange  '#cb4b16'
set -g @yellow  '#b58900'
set -g @green   '#859900'
set -g @aqua    '#2aa198'
set -g @blue    '#268bd2'
set -g @purple  '#6c71c4'
set -g @grey0   '#839496'
set -g @grey1   '#586e75'
set -g @statusline1 '#859900'
set -g @statusline2 '#93a1a1'
set -g @statusline3 '#dc322f'

set-option -g status "on"
set -g status-interval 2

# Status bar tổng thể
set-option -g status-style fg='#{@fg}',bg='#{@bg0}'

# ---- Windows ----
# inactive window → nền tối, chữ xám
set-window-option -g window-status-style fg='#{@grey1}',bg='#{@bg0}'

# window có activity → nền vàng nhạt, chữ đậm
set-window-option -g window-status-activity-style 'fg=#{@yellow},bg=#{@bg0},bold'

# active window → nền xanh dương, chữ sáng
set-window-option -g window-status-current-style fg='#{@bg0}',bg='#{@blue}',bold

# ---- Pane ----
set-option -g pane-border-style fg='#{@bg1}'          # inactive border → xám mờ
set-option -g pane-active-border-style fg='#{@blue}'  # active border → xanh nổi bật

# ---- Command & Message ----
set-option -g message-style fg='#{@bg0}',bg='#{@orange}',bold
set-option -g message-command-style fg='#{@bg0}',bg='#{@yellow}',bold

# ---- Clock ----
set-window-option -g clock-mode-colour '#268bd2'

# ---- Status Left ----
set-option -g status-left-style bold
set -g status-left-length 60
set -g status-left '#[fg=#{@bg0},bg=#{@green}] #S #[fg=#{@green},bg=#{@bg0}] #{uptime} '

# ---- Status Right ----
set-option -g status-right-style bold
set -g status-right-length 150
set -g status-right '#[fg=#{@fg},bg=#{@bg0}] C:#{cpu_percentage} R:#{ram_percentage} #[fg=#{@bg0},bg=#{@red}] %Y-%m-%d %H:%M #[fg=#{@bg0},bg=#{@blue}] #h '

# ---- Window Format ----
set -g window-status-separator ''
set -g window-status-format "#[fg=#{@grey0},bg=#{@bg0}] #I #[fg=#{@grey0},bg=#{@bg0}]#W "
set -g window-status-current-format "#[fg=#{@bg0},bg=#{@blue}] #I #[fg=#{@bg0},bg=#{@blue}]#W "

# ---- Plugins ----
run '~/.tmux/plugins/tpm/tpm'
